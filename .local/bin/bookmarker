#!/bin/sh
bookmark=$(xclip -o -selection clipboard)
title=$(wget -qO- $bookmark |
  gawk -v IGNORECASE=1 -v RS='</title' 'RT{gsub(/.*<title[^>]*>/,"");print;exit}')

[ -z "$title" ] && notify-send "url not found" && exit

if grep -qF "$title" ~/.config/surf/bookmark_titles; then
	notify-send "'$title' already in bookmarks"
else
	echo "$bookmark" >> ~/.config/surf/bookmarks
	echo "|$title"";" >> ~/.config/surf/bookmark_titles
	notify-send "'$title' added to bookmarks"
fi
